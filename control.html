<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>ISATIS</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/png" href="images/isatis.png">
</head>

<body class="control-page">

    <div class="control-login-box">
        <h2>Ingrese la contraseña</h2>

        <input type="password" id="pass" class="control-input" placeholder="Contraseña">

        <button class="btn-login" onclick="login()">Entrar</button>

        <div id="control-msg"></div>
    </div>

    <script>
        function showMsg(text) {
            document.getElementById("control-msg").innerHTML = text;
        }

        async function login() {
            const password = document.getElementById("pass").value;

            try {
                const res = await fetch("https://api-camara.vercel.app/login", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ password })
                });

                if (res.ok) {
                    const data = await res.json();
                    if (data.status === "ok") {
                        localStorage.setItem("auth", "ok");
                        window.location.href = "index.html";
                    } else {
                        showMsg("Contraseña incorrecta");
                    }
                } else {
                    showMsg("Contraseña incorrecta");
                }

            } catch (err) {
                console.error(err);
                showMsg("Error de conexión");
            }
        }
    </script>

</body>

</html>